<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <style>
    #drag {
      width: 100px;
      height: 100px;
      background: linear-gradient(45deg, #ffccff, #ccffff);
      position: absolute;
    }
  </style>
</head>
<body>
  <div id="drag"></div>
  <script>
    /**
     * 1 窗口坐标，e.clientX/e.clientY
     * 2 文档坐标，e.pageX/e.pageY
     * 3 获取元素在窗口的坐标，elem.getBoundingClientRect(),兼容性差,可以使用elem.offsetLeft
    */
    function move(e){
      if(flag){
        //获取div元素的坐标位置
        let left = e.clientX - offsetx;
        let top = e.clientY - offsety;
        drag.style.left = left + 'px';
        drag.style.top = top + 'px';
        console.log(left, top)
      }
    }

    function toggle(e){
      flag = !flag;
      if(flag){
        //获取鼠标相对于元素的坐标
        // let pos = drag.getBoundingClientRect();
        // offsetx = e.clientX - pos.left;
        // offsety = e.clientY - pos.top;
        offsetx = e.clientX - drag.offsetLeft;
        offsety = e.clientY - drag.offsetTop;
      }
    }

    let flag = false;
    let offsetx = 0;
    let offsety = 0;

    const drag = document.querySelector('#drag');
    drag.addEventListener('mousedown', toggle);
    drag.addEventListener('mouseup', toggle);
    window.addEventListener('mousemove', move);

  </script>
</body>
</html>